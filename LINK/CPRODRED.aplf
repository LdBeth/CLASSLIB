 C←CPRODRED A;⎕IO;RHO;D;E;CC;L;NOTEST
⍝ COMPUTES THE PRODUCT REDUCTION ALONG THE LAST
⍝ AXIS OF AN ARRAY OF COMPLEX NUMBERS.
 NOTEST←0
 A←CNRMLZ A
 →(1=⍴⍴C←A)/0
 ⎕IO←1
 L←×/RHO←¯2↓⍴C
 C←(L,¯2↑⍴C)⍴C
 →(0=(⍴C)[2])/ZERO
 NOTEST←1
LOOP:→(1=D←(⍴C)[2])/ONE
 CC←((L,E,2)↑C)CPROD(L,(-E←⌊D÷2),2)↑C
 C←CC,[2]C[;(E+1)×⍳D≠2×E;]
 →LOOP
ZERO:C←(RHO,2)⍴1 0
 →0
ONE:C←(RHO,2)⍴C
