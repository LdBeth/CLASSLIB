 C←A FRPOWER B;RHO;I;J;⎕IO;M
⍝ COMPUTES THE B-TH POWER OF  A  IN THE FINITE RING
⍝ USING THE BINARY POWER ALGORITHM.
 ⎕IO←0
 DERR(FRTEST A)∧∧/,(B=⌊B),B≥0
 EXPAND
 RHO←⍴A
 C←(⍴A←,A)⍴1
 I←(B>0)/⍳⍴B←,B
 M←1↑⍴FRTIMES
LOOP:C[J]←(,FRTIMES)[A[J]+M×C[J←(2|B[I])/I]]
 →(0=⍴I←(B[I]≥2)/I)/END
 A[I]←(,FRTIMES)[A[I]×M+1]
 B[I]←⌊B[I]÷2
 →LOOP
END:C←RHO⍴C
