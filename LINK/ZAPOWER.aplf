 C←A ZAPOWER B;R;RHO;I;J;M
⍝ COMPUTES THE B-TH POWER OF  A  IN THE CURRENT
⍝ Z-ALGEBRA.
 DERR∧/(,B=⌊B),,B≥0
 A←ZANRMLZ A
 B←((⍴B),1)⍴B
 EXPANDV
 R←×/¯1↓RHO←⍴A
 A←(R,M←¯1↑⍴A)⍴A
 C←(⍴A)⍴M↑1
 I←(B>0)/⍳⍴B←,B
LOOP:C[J;]←C[J;]ZAPROD A[J←(2|B[I])/I;]
 →(0=⍴I←(B[I]≥2)/I)/END
 A[I;]←A[I;]ZAPROD A[I;]
 B[I]←⌊B[I]÷2
 →LOOP
END:C←RHO⍴C
