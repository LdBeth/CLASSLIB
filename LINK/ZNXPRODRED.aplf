 C←ZNXPRODRED A;⎕IO;RHO;D;E;CC;L;M
⍝ COMPUTES THE PRODUCT REDUCTION ALONG THE LAST
⍝ AXIS OF AN ARRAY OF POLYNOMIALS OVER THE INTEGERS
⍝ MODULO  n, WHICH MUST NOT EXCEED 1E7.
 →(1≥⍴⍴C←A)/0
 ⎕IO←1
 L←×/RHO←¯2↓⍴C
 C←(L,¯2↑⍴C)⍴C
 →(0=(⍴C)[2])/ZERO
LOOP:→(1=D←(⍴C)[2])/ONE
 CC←((L,E,¯1↑⍴C)↑C)ZNXPROD(L,(-E←⌊D÷2),¯1↑⍴C)↑C
 →(D≠2×E)/ODD
 C←CC
 →LOOP
ODD:M←(+/∨\⌽∨⌿0≠C[;E+1;])⌈¯1↑⍴CC
 C←((L,M)↑C[;E+1;]),[2]((¯1↓⍴CC),M)↑CC
 →LOOP
ONE:C←(RHO,¯1↑⍴C)⍴C
 →0
ZERO:C←(RHO,1)⍴1
