 C←A ZNPROD B;RHO;D;Q;⎕IO
⍝ COMPUTES  n|A×B  USING MULTIPLE PRECISION IF  n ≥ 1E7.
 →NOTEST/BEGIN
 DERR∧/(,A=⌊A←n|A),,B=⌊B←n|B
BEGIN:→(n>10000000)/GEN
 C←n|A×B
 →0
GEN:EXPAND
 RHO←⍴A
 ⎕IO←1
 D←(Q←3⍴M←1000000)⊤⌊((A←,A)×B←,B)÷n
 A←Q⊤A
 B←Q⊤B
 C←(5 3,1↓⍴A)↑((2 1 3⍉(3⍴1)∘.×A)×(3⍴1)∘.×B)-(Q⊤n)∘.×D
 C←+/[2](0 ¯1 ¯2∘.×(1↓⍴A)⍴1)⌽[1]C
LOOP:C[1↓⍳5;]←¯499999+M|D←499999+1 0↓C
 C[⍳4;]←(¯1 0↓C)+⌊D÷M
 →(∨/,0≠¯3 0↓C)/LOOP
 C←n|RHO⍴M⊥2 0↓C
