 C←A QMATPROD B;⎕IO;X;AX;BX;RR;NOTEST;RA;RB
⍝ COMPUTES THE MATRIX PRODUCT OF TWO NONSCALAR ARRAYS
⍝ OF RATIONAL NUMBERS.
 ⎕IO←1
 NOTEST←0
 A←QNRMLZ A
 B←QNRMLZ B
 DERR∧/2≤(⍴⍴A),⍴⍴B
 DERR(⍴A)[¯1+⍴⍴A]=1↑⍴B
 C←((RA←¯2↓⍴A),(RB←¯1↓1↓⍴B),2)⍴0 1
 X←1=⍳1↑⍴B
 RR←((⍴RA)+⍳⍴RB),(⍳⍴RA),⍴⍴C
 NOTEST←1
LOOP:AX←RR⍉(RB,RA,2)⍴X/[¯1+⍴⍴A]A
 BX←(⍴C)⍴X⌿B
 C←C QSUM AX QPROD BX
 →(~1↑X←¯1⌽X)/LOOP
