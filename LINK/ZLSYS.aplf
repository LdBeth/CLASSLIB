 C←A ZLSYS B;⎕IO;M;D;Q;r;s
⍝ SOLVES LINEAR SYSTEMS OVER THE INTEGERS.
⍝ A  IS THE MATRIX OF COEFFICIENTS AND THE VECTORS
⍝ OF CONSTANT TERMS ARE THE VECTORS ALONG THE FIRST
⍝ AXIS OF  B.  THE ROWS OF THE GLOBAL ARRAY  w
⍝ ARE A BASIS FOR THE SOLUTIONS OF THE CORRESPONDING
⍝ HOMOGENEOUS SYSTEM.
 ⎕IO←1
 DERR∧/(2=⍴⍴A),(,A=⌊A),(,B=⌊B),(1≤⍴⍴B),(1↑⍴A)=1↑⍴B
 D←(M←+/D≠0)↑D←1 1⍉A←ZREDUCE A
 DERR∧/,0=(M,(¯1+⍴⍴B)⍴0)↓B←r+.×B
 w←⍉(0,M)↓s
 DERR∧/0=(Q←⍉(⌽⍴B)⍴D)|B←(M,1↓⍴B)↑B
 C←(((1↑⍴s),M)↑s)+.×⌊B÷Q
