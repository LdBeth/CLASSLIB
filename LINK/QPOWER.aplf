 C←A QPOWER B;RHO;RC;I;J;NOTEST
⍝ COMPUTES THE B-TH POWER OF THE RATIONAL
⍝ ARRAY  A  USING THE BINARY POWER ALGORITHM.
 NOTEST←0
 A←QNRMLZ A
 DERR∧/(,B=⌊B),,B≥0
 B←((⍴B),1)⍴B
 EXPANDV
 RC←(×/¯1↓RHO←⍴A),2
 A←RC⍴A
 C←RC⍴1 1
 I←(B>0)/⍳⍴B←,B
 NOTEST←1
LOOP:C[J;]←C[J;]QPROD A[J←(2|B[I])/I;]
 →(0=⍴I←(B[I]≥2)/I)/END
 A[I;]←A[I;]QPROD A[I;]
 B[I]←⌊B[I]÷2
 →LOOP
END:C←RHO⍴C
