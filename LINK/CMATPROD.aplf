 C←A CMATPROD B;⎕IO;X;AX;BX;RR;NOTEST;RA;RB
⍝ COMPUTES THE MATRIX PRODUCT OF TWO NONSCALAR ARRAYS
⍝ OF COMPLEX NUMBERS.
 NOTEST←0
 ⎕IO←1
 A←CNRMLZ A
 B←CNRMLZ B
 DERR(∧/1<(⍴⍴A),⍴⍴B)∧(⍴A)[¯1+⍴⍴A]=1↑⍴B
 C←((RA←¯2↓⍴A),(RB←¯1↓1↓⍴B),2)⍴0
 NOTEST←1
 X←1=⍳1↑⍴B
 RR←((⍴RA)+⍳⍴RB),(⍳⍴RA),⍴⍴C
LOOP:AX←RR⍉(RB,RA,2)⍴X/[¯1+⍴⍴A]A
 C←C CSUM AX CPROD(⍴C)⍴X⌿B
 →(~1↑X←¯1⌽X)/LOOP
