 C←A ZNXMATPROD B;⎕IO;M;X;AX;BX;RR;RA;RB
⍝ COMPUTES THE MATRIX PRODUCT OF TWO NONSCALAR ARRAYS
⍝ OF INTEGER POLYNOMIALS MODULO n.
 ⎕IO←1
 DERR∧/(2≤(⍴⍴A),⍴⍴B),((⍴A)[¯1+⍴⍴A]=M←1↑⍴B)
 C←((RA←¯2↓⍴A),(RB←¯1↓1↓⍴B),1)⍴0
 X←1=⍳M
 RR←((⍴RA)+⍳⍴RB),(⍳⍴RA),⍴⍴C
LOOP:AX←RR⍉(RB,RA,¯1↑⍴A)⍴X/[¯1+⍴⍴A]A
 BX←((¯1↓⍴C),¯1↑⍴B)⍴X⌿B
 C←C ZNXSUM AX ZNXPROD BX
 →(~1↑X←¯1⌽X)/LOOP
